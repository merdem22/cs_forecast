# Forecasting: two 3-second frames with stride 2
seed: 20170629

dataset:
  npz: data/npz/cdms_fc_3s_stride2x2.npz
  input_windows: 1
  forecast_windows: 0
  task: detection
  level_tau: 0.5
  stride: 1
  num_workers: 8
  batch_size: 96
  pin_memory: true
  channel_remap: null

model:
  name: cnn
  params:
    in_channels_eeg: 14
    time_len: 768          # 3 seconds * 256 Hz
    width: [64, 128]
    kernels: [11, 7]
    p_drop: 0.2
    input_windows: 1
    pool_after: [0]
    pretrained:
      encoder_path: null
      strict: true
      freeze_encoder: false
      freeze_head: false
      trainable_layers: null
      finetune:
        head_lr: null
        encoder_lr: null

optimizer:
  lr: 0.0003
  weight_decay: 0.002

trainer:
  max_epochs: 50
  min_epochs: 10
  max_folds: null
  accelerator: auto
  devices: 1
  enable_checkpointing: true
  gradient_clip_val: 1.0
  log_every_n_steps: 25

folds:
  mode: kfold
  num_folds: 5
  seed: 20170629

scheduler:
  type: cosine
  t_max: 50
  eta_min: 5e-5

wandb:
  enabled: true
  project: cdms-forecast
  name: cnn_fc_3s_stride2x2

report:
  threshold: 0.5
